@startuml C4-Component
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml

title English Learning App - Component Diagram

Container(mobileApp, "Android Mobile App", "Kotlin, Android SDK", "Mobile application container")

Container_Boundary(app, "Mobile App Components") {
    ' Presentation Layer
    Component(mainActivity, "MainActivity", "Activity", "Main navigation screen with app entry points")
    Component(dictionaryActivity, "DictionaryActivity", "Activity", "Word search and definition selection")
    Component(revisionActivity, "RevisionActivity", "Activity", "Vocabulary revision and testing")
    
    ' ViewModel Layer
    Component(mainViewModel, "MainViewModel", "ViewModel", "Manages main screen state and navigation")
    Component(dictionaryViewModel, "DictionaryViewModel", "ViewModel", "Handles word search and definition selection logic")
    Component(revisionViewModel, "RevisionViewModel", "ViewModel", "Manages revision flow and answer validation")
    
    ' Repository Layer
    Component(wordRepository, "WordRepository", "Repository", "Manages local word data operations and caching")
    Component(apiRepository, "ApiRepository", "Repository", "Handles API communication and response processing")
    
    ' Data Access Layer
    Component(wordDao, "WordDao", "DAO", "Database access object for word operations")
    Component(apiService, "DictionaryApiService", "Service", "Retrofit interface for API calls")
    
    ' Utility Components
    Component(networkManager, "NetworkManager", "Utility", "Network connectivity and state management")
    Component(validationUtils, "ValidationUtils", "Utility", "Input validation and answer checking")
    Component(cacheManager, "CacheManager", "Utility", "API response caching and management")
}

ContainerDb(database, "SQLite Database", "Room", "Local data storage")
System_Ext(api, "Cambridge Dictionary API", "External dictionary service")

' Presentation Layer Relationships
Rel(mainActivity, mainViewModel, "Uses")
Rel(dictionaryActivity, dictionaryViewModel, "Uses")
Rel(revisionActivity, revisionViewModel, "Uses")

' ViewModel to Repository Relationships
Rel(mainViewModel, wordRepository, "Uses")
Rel(dictionaryViewModel, wordRepository, "Uses")
Rel(dictionaryViewModel, apiRepository, "Uses")
Rel(revisionViewModel, wordRepository, "Uses")

' Repository to Data Access Relationships
Rel(wordRepository, wordDao, "Uses")
Rel(wordRepository, cacheManager, "Uses")
Rel(apiRepository, apiService, "Uses")
Rel(apiRepository, networkManager, "Uses")
Rel(apiRepository, cacheManager, "Uses")

' Utility Relationships
Rel(revisionViewModel, validationUtils, "Uses")
Rel(dictionaryViewModel, validationUtils, "Uses")

' External Dependencies
Rel(wordDao, database, "Queries")
Rel(apiService, api, "HTTP calls")

' Navigation Flow
Rel(mainActivity, dictionaryActivity, "Navigates to")
Rel(mainActivity, revisionActivity, "Navigates to")

note right of dictionaryActivity
  **Responsibilities:**
  - Word search interface
  - Definition display
  - Definition selection
  - Save word to database
  
  **UI Components:**
  - Search EditText
  - Definitions RecyclerView
  - Save Button
end note

note right of revisionActivity
  **Responsibilities:**
  - Stage selection
  - Word display
  - Answer input
  - Progress tracking
  
  **UI Components:**
  - Stage Spinner
  - Word display area
  - Answer EditText
  - Submit Button
end note

note right of wordRepository
  **Operations:**
  - CRUD operations for words
  - Stage-based queries
  - Progress tracking
  - Data validation
  
  **Caching:**
  - In-memory cache
  - Database optimization
end note

note right of apiRepository
  **Features:**
  - API call management
  - Response parsing
  - Error handling
  - Retry logic
  - Offline fallback
end note

@enduml
